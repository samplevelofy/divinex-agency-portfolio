---
// No Astro server-side logic needed for this component right now.
// Client-side interactivity is handled in the <script> block.
---

<nav id="main-navbar" class="main-navbar">
  <div class="container navbar-content">
    <button
      id="home-link"
      class="logo-button"
      aria-label="Home"
    >
      <i class="fa-solid fa-palette logo-icon"></i>
      <span class="logo-text">Divinex Agency</span>
    </button>

    <div class="desktop-nav-links">
      <button class="nav-link" data-href="#home">Home</button>
      <button class="nav-link" data-href="#services">Services</button>
      <button class="nav-link" data-href="#portfolio">Portfolio</button>
      <button class="nav-link" data-href="#about">About</button>
      <button class="nav-link" data-href="#contact">Contact</button>
      <a href="/admin/login" class="btn-admin">Admin Login</a>
    </div>

    <button
      id="mobile-menu-button"
      class="mobile-menu-toggle"
      aria-label="Toggle menu"
    >
      <i class="fa-solid fa-bars menu-icon" id="menu-icon"></i>
      <i class="fa-solid fa-xmark close-icon" id="close-icon" style="display: none;"></i>
    </button>
  </div>

  <div id="mobile-menu" class="mobile-menu-dropdown">
    <div class="container mobile-nav-list">
      <button class="nav-link-mobile" data-href="#home">Home</button>
      <button class="nav-link-mobile" data-href="#services">Services</button>
      <button class="nav-link-mobile" data-href="#portfolio">Portfolio</button>
      <button class="nav-link-mobile" data-href="#about">About</button>
      <button class="nav-link-mobile" data-href="#contact">Contact</button>
      <a href="/admin/login" class="btn-admin-mobile">Admin Login</a>
    </div>
  </div>
</nav>

<script>
  // Client-side JavaScript for Navbar interactivity
  document.addEventListener('astro:page-load', () => {
    console.log('Navbar script (astro:page-load) initialized!'); // DIAGNOSTIC LOG

    const navbar = document.getElementById('main-navbar');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');
    const homeLinkButton = document.getElementById('home-link');

    // Defensive checks for element existence
    if (!navbar || !mobileMenuButton || !mobileMenu || !menuIcon || !closeIcon || !homeLinkButton) {
        console.error('Navbar elements not found, skipping script initialization.');
        return;
    }

    let isMobileMenuOpen = false; // State to track mobile menu visibility

    // Function to toggle mobile menu visibility
    const toggleMobileMenu = () => {
      isMobileMenuOpen = !isMobileMenuOpen;
      if (isMobileMenuOpen) {
        mobileMenu.style.display = 'block'; // Show dropdown
        menuIcon.style.display = 'none'; // Hide hamburger icon
        closeIcon.style.display = 'block'; // Show 'X' icon
      } else {
        mobileMenu.style.display = 'none'; // Hide dropdown
        menuIcon.style.display = 'block'; // Show hamburger icon
        closeIcon.style.display = 'none'; // Hide 'X' icon
      }
    };

    // Function to handle navbar scroll styling
    const handleScroll = () => {
      if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    };

    // Function to smoothly scroll to a section
    const scrollToSection = (event) => {
      const href = event.currentTarget.dataset.href;
      if (href) {
        const element = document.querySelector(href);
        if (element) {
          element.scrollIntoView({ behavior: 'smooth' });
        }
        // Close mobile menu if open after clicking a link
        if (isMobileMenuOpen) {
          toggleMobileMenu();
        }
      }
    };

    // Event Listeners
    mobileMenuButton.addEventListener('click', toggleMobileMenu);
    window.addEventListener('scroll', handleScroll);

    // Attach scroll behavior to desktop nav links
    document.querySelectorAll('.desktop-nav-links .nav-link').forEach(link => {
        link.addEventListener('click', scrollToSection);
    });

    // Attach scroll behavior to mobile nav links
    document.querySelectorAll('.mobile-nav-list .nav-link-mobile').forEach(link => {
        link.addEventListener('click', scrollToSection);
    });

    // Handle home button (logo) click
    homeLinkButton.addEventListener('click', (event) => {
        event.preventDefault(); // Prevent default button behavior
        const homeSection = document.getElementById('home');
        if (homeSection) {
            homeSection.scrollIntoView({ behavior: 'smooth' });
        }
        // Close mobile menu if open
        if (isMobileMenuOpen) {
            toggleMobileMenu();
        }
    });

    // Initial setup on page load
    handleScroll(); // Apply initial scroll styling
    mobileMenu.style.display = 'none'; // Ensure mobile menu is hidden by default
  });
</script>