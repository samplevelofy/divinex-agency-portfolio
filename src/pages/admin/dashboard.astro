---
// admin/dashboard.astro - Admin Dashboard
import Layout from '../../layouts/Layout.astro';
// import { supabase } from '~/lib/supabase'; // Not directly used in this file's script block
import { getSessionUser } from '../../lib/session.ts'; // <--- CORRECTED: New import

const user = await getSessionUser(); // <--- CORRECTED: Call new function

if (!user) {
    return Astro.redirect('/admin/login');
}
---

<Layout title="Admin Dashboard">
    <section class="admin-dashboard-section">
        <div class="container admin-dashboard-container">
            <h1 class="heading-2 text-center mb-xl">Welcome, Divinex Admin!</h1>
            <p class="text-center text-neutral-600 mb-lg">
                Manage your portfolio, categories, and site settings.
            </p>

            <div class="admin-nav-links">
                <a href="/admin/projects" class="admin-link-card">
                    <i class="fa-solid fa-folder-open admin-icon"></i>
                    <span>Manage Projects</span>
                </a>
                <a href="/admin/categories" class="admin-link-card">
                    <i class="fa-solid fa-tags admin-icon"></i>
                    <span>Manage Categories</span>
                </a>
                <a href="/admin/contact-leads" class="admin-link-card">
                    <i class="fa-solid fa-envelope admin-icon"></i>
                    <span>Contact Leads</span>
                </a>
                <a href="/admin/settings" class="admin-link-card">
                    <i class="fa-solid fa-gear admin-icon"></i>
                    <span>Settings</span>
                </a>
            </div>

            <a href="/admin/logout" class="btn-primary-full-width logout-link mt-3xl">
                <i class="fa-solid fa-right-from-bracket mr-2"></i> Logout
            </a>
        </div>
    </section>
</Layout>